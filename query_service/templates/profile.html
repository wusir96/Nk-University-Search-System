<!DOCTYPE html>
<html>
<head>
    <title>ä¸ªäººä¸­å¿ƒ - å—å¼€æœç´¢å¼•æ“</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .profile-container { max-width: 1000px; margin: 0 auto; }
        .user-info { background: #e7f3ff; padding: 20px; border-radius: 10px; margin-bottom: 30px; }
        .history-section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
        .history-item { padding: 10px; margin: 5px 0; background: #f8f9fa; border-radius: 3px; border-left: 4px solid #007bff; }
        .timestamp { color: #666; font-size: 12px; }
        .query-text { font-weight: bold; color: #333; }
        .results-count { color: #28a745; }
        .navigation { text-align: center; margin: 20px 0; }
        .navigation a { color: #007bff; text-decoration: none; margin: 0 15px; }
        .navigation a:hover { text-decoration: underline; }
        h1, h2 { color: #333; }
        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 5px; text-align: center; }
        .stat-number { font-size: 24px; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <div class="profile-container">
        <h1>ğŸ‘¤ ä¸ªäººä¸­å¿ƒ</h1>
        
        <div class="user-info">
            <h2>ç”¨æˆ·ä¿¡æ¯</h2>
            <p><strong>ç”¨æˆ·åï¼š</strong>{{ session.username }}</p>
            <p><strong>èº«ä»½ï¼š</strong>{{ session.role }}</p>
            <p><strong>å­¦é™¢ï¼š</strong>{{ session.college or 'æœªè®¾ç½®' }}</p>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number">{{ query_history|length }}</div>
                <div>æŸ¥è¯¢æ¬¡æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ click_history|length }}</div>
                <div>ç‚¹å‡»æ¬¡æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">
                    {% set total_results = query_history|sum(attribute=1) %}
                    {{ total_results }}
                </div>
                <div>æ€»ç»“æœæ•°</div>
            </div>
        </div>
        
        <div class="history-section">
            <h2>ğŸ” æŸ¥è¯¢å†å²ï¼ˆæœ€è¿‘50æ¡ï¼‰</h2>
            {% if query_history %}
                {% for query, results_count, timestamp in query_history %}
                <div class="history-item">
                    <div class="query-text">{{ query }}</div>
                    <div class="timestamp">
                        {{ timestamp }} - 
                        <span class="results-count">{{ results_count }} ä¸ªç»“æœ</span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p>æš‚æ— æŸ¥è¯¢å†å²</p>
            {% endif %}
        </div>
        
        <div class="history-section">
            <h2>ğŸ–±ï¸ ç‚¹å‡»å†å²ï¼ˆæœ€è¿‘50æ¡ï¼‰</h2>
            {% if click_history %}
                {% for url, from_query, timestamp in click_history %}
                <div class="history-item">
                    <div class="query-text">
                        <a href="{{ url }}" target="_blank">{{ url[:80] }}{% if url|length > 80 %}...{% endif %}</a>
                    </div>
                    <div class="timestamp">
                        {{ timestamp }}
                        {% if from_query %} - æ¥è‡ªæŸ¥è¯¢: "{{ from_query }}"{% endif %}
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p>æš‚æ— ç‚¹å‡»å†å²</p>
            {% endif %}
        </div>
        
        <div class="navigation">
            <a href="/">ğŸ  è¿”å›æœç´¢</a> |
            <a href="/demo">ğŸ¯ åŠŸèƒ½æ¼”ç¤º</a> |
            <a href="/logout">ğŸšª é€€å‡ºç™»å½•</a>
        </div>
    </div>
</body>
</html>